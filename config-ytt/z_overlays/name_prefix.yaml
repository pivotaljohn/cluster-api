#@ load("@ytt:overlay", "overlay")
#@ load("prefix.star", "name_prefix");

#@ def prefixed(curr, _):
#@   return name_prefix+curr if not curr.startswith(name_prefix) else curr
#@ end

#@overlay/match by=overlay.not_op(overlay.subset({"kind": "CustomResourceDefinition"})), expects="1+"
#@overlay/match-child-defaults when=1
---
metadata:
  #@overlay/replace via=prefixed
  name:
roleRef:
  #@overlay/replace via=prefixed
  name:
spec:
  #@overlay/match-child-defaults when="0+"
  dnsNames:
  #@overlay/match by=overlay.all
  #@overlay/replace via=prefixed
  -
  template:
    spec:
      #@overlay/match-child-defaults when="0+"
      volumes:
      #@overlay/match by=overlay.all
      #@overlay/match-child-defaults when=1
      - 
        secret:
          #@overlay/replace via=prefixed
          secretName:
  issuerRef:
    #@overlay/replace via=prefixed
    name:
  #@overlay/replace via=prefixed
  secretName:

